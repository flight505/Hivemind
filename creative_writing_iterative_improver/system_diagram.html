<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iterative Creative Improvement System</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(42, 42, 42, 0.9);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #00ff88;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        .description {
            text-align: center;
            color: #cccccc;
            margin-bottom: 30px;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .mermaid-container {
            background: rgba(26, 26, 26, 0.8);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #444;
        }

        .legend {
            margin-top: 30px;
            padding: 20px;
            background: rgba(0, 136, 255, 0.1);
            border-radius: 8px;
            border-left: 4px solid #0088ff;
        }

        .legend h3 {
            color: #0088ff;
            margin-top: 0;
        }

        .legend ul {
            color: #cccccc;
            padding-left: 20px;
        }

        .legend li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎨 Iterative Creative Improvement System</h1>

        <div class="description">
            <p>A sophisticated AI-powered system that uses conflicting evaluator personas to iteratively improve creative text through parallel evaluation, contextual feedback, and controlled rewriting.</p>
        </div>

        <div class="mermaid-container">
            <div class="mermaid">
                flowchart TD
                    %% Start and Initialization
                    A[📝 Original Text] --> B{Does personas.json exist?}
                    B -->|No| C[🤖 Generate Conflicting Personas]
                    B -->|Yes| D[📂 Load Existing Personas]
                    C --> E[💾 Save personas.json]
                    D --> E
                    E --> F[🚀 Start Iterative Loop<br/>iteration = 1]

                    %% Main Loop
                    F --> G[🔍 Parallel Evaluation]
                    G --> H[📊 5 Personas Grade Text<br/>3 Rubrics Each + Suggestions]

                    H --> I[📋 Aggregate Feedback<br/>With Persona Context & Scores]

                    I --> J[✍️ Rewrite Text<br/>With System Constraints]
                    J --> K{Length Check<br/>≤110% of Original?}

                    K -->|No| L[🔄 Retry with Stronger<br/>Length Constraints<br/>Up to 3 attempts]
                    L --> K

                    K -->|Yes| M[✅ Successful Rewrite<br/>Update Conversation History]

                    %% Progress Tracking
                    M --> N[📈 Generate Progress Plot<br/>Average Scores + Persona Breakdown]
                    N --> O[💾 Save Results<br/>JSON + Text Files]

                    O --> P{Target Score Reached?<br/>≥9.0/10 Average}
                    P -->|Yes| Q[🎉 Success!<br/>Target Achieved]

                    P -->|No| R{Max Iterations?<br/>50 iterations}
                    R -->|Yes| S[🏁 Complete<br/>Max Iterations Reached]
                    R -->|No| T[🔄 Next Iteration<br/>iteration++]
                    T --> G

                    S --> U[💾 Save Best Version<br/>best_version_score_X.X.txt]
                    Q --> U
                    U --> V[📊 Final Summary<br/>final_summary.json]

                    %% Styling and connections
                    classDef startClass fill:#00ff88,stroke:#00aa66,stroke-width:3px,color:#000
                    classDef processClass fill:#0088ff,stroke:#0055aa,stroke-width:2px,color:#fff
                    classDef decisionClass fill:#ffaa00,stroke:#aa7700,stroke-width:2px,color:#000
                    classDef successClass fill:#00ff88,stroke:#00aa66,stroke-width:3px,color:#000
                    classDef errorClass fill:#ff4444,stroke:#aa2222,stroke-width:2px,color:#fff

                    class A,C,D,E,F,M,N,O,Q,S,U,V startClass
                    class G,H,I,J,L,P,R,T processClass
                    class B,K decisionClass
            </div>
        </div>

        <div class="legend">
            <h3>🔑 System Components</h3>
            <ul>
                <li><strong>🤖 Conflicting Personas:</strong> 5 AI evaluators with different expertise creating natural tension</li>
                <li><strong>🔍 Parallel Evaluation:</strong> All personas grade simultaneously for efficiency</li>
                <li><strong>📋 Contextual Feedback:</strong> Suggestions include persona expertise and their rating</li>
                <li><strong>✍️ Controlled Rewriting:</strong> Length constraints with retry mechanism</li>
                <li><strong>📈 Live Visualization:</strong> Progress plot updates after each iteration</li>
                <li><strong>💾 Comprehensive Logging:</strong> All iterations saved for analysis</li>
            </ul>
        </div>
    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#00ff88',
                primaryTextColor: '#000000',
                primaryBorderColor: '#00aa66',
                lineColor: '#ffffff',
                sectionBkgColor: '#2a2a2a',
                altSectionBkgColor: '#1a1a1a',
                gridColor: '#444444',
                tertiaryColor: '#0088ff'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>
